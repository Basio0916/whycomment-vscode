# Repository Guidelines

## Project Structure & Module Organization
- `src/extension.ts`: Extension entry; registers commands, view, settings.
- `src/*.ts`: Core modules (e.g., `GitDiffService.ts`, `git.ts`, `llm.ts`, `tree.ts`, `utils.ts`).
- `src/test/*.test.ts`: Tests discovered by VS Code’s test runner.
- `src/types/`: Ambient type declarations.
- `out/`: Compiled JavaScript (generated by TypeScript).

## Build, Test, and Development Commands
- `npm install`: Install dependencies.
- `npm run watch`: Compile on change; use during development.
- `npm run compile`: One‑off TypeScript build to `out/`.
- Run/Debug: Press `F5` in VS Code (Launch Extension Host).
- Tests: Use VS Code Testing view after `npm run watch`. Optional CLI: `npx @vscode/test-cli -c .vscode-test.mjs`.

## Coding Style & Naming Conventions
- Language: TypeScript with `strict` mode.
- Indentation: 2 spaces; include semicolons.
- Prefer `eqeqeq`, curly braces, and avoid throwing literals (mirrors ESLint rules).
- Naming: camelCase for variables/functions, PascalCase for classes; follow existing file patterns (e.g., `extension.ts`, `GitDiffService.ts`).
- Linting: ESLint (`eslint.config.mjs`) with `@typescript-eslint`; fix warnings before PR.

## Testing Guidelines
- Framework: VS Code Extension Test Runner (Mocha types enabled via `tsconfig.json`).
- Location: `src/test/`, name as `*.test.ts`.
- Run: `npm run watch` then execute tests in the Testing view. Aim for focused unit tests around `GitDiffService` and `llm` behavior.

## Commit & Pull Request Guidelines
- Commits: Short, imperative summaries (English or Japanese). Examples: `Fix Windows path handling`, `Implement diff engine`. No strict Conventional Commits required.
- PRs: Describe intent, link issues, include before/after screenshots for UI changes, and steps to verify (commands/settings used). Update `CHANGELOG.md` when user‑visible behavior changes.

## Security & Configuration Tips
- Secrets: Never commit API keys. Configure via VS Code settings: `whycomment.apiKey` and model options.
- Git required: Features depend on `git diff` against `HEAD`.
- Performance: Large diffs may be skipped; respect existing limits in settings.

## エージェント向け指示（日本語応答）
- 返答は日本語で、簡潔かつ丁寧（です・ます調）に記述してください。
- 重要事項を先に述べ、冗長な説明や過度な装飾は避けてください。
- コマンド・ファイルパス・識別子はバッククォート（`）で囲みます。
- 箇条書きを優先し、必要に応じて短い見出しを使います。
- 不明点は端的に確認質問を行い、前提・制約（`git` 必須、API キー有無など）を一言明示します。
- 出力分量の目安は200〜400字（内容に応じて調整可）。既存のスタイルと最小差分を心掛けます。
